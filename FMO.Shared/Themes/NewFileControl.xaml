<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    xmlns:local="clr-namespace:FMO.Shared">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/HandyControl;component/Themes/SkinDefault.xaml" />
        <ResourceDictionary Source="pack://application:,,,/HandyControl;component/Themes/Theme.xaml" />

    </ResourceDictionary.MergedDictionaries>

    <Geometry x:Key="f.book-open-reader">M160 96a96 96 0 1 1 192 0A96 96 0 1 1 160 96zm80 152l0 264-48.4-24.2c-20.9-10.4-43.5-17-66.8-19.3l-96-9.6C12.5 457.2 0 443.5 0 427L0 224c0-17.7 14.3-32 32-32l30.3 0c63.6 0 125.6 19.6 177.7 56zm32 264l0-264c52.1-36.4 114.1-56 177.7-56l30.3 0c17.7 0 32 14.3 32 32l0 203c0 16.4-12.5 30.2-28.8 31.8l-96 9.6c-23.2 2.3-45.9 8.9-66.8 19.3L272 512z</Geometry>
    <Geometry x:Key="f.clone">M288 448L64 448l0-224 64 0 0-64-64 0c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l224 0c35.3 0 64-28.7 64-64l0-64-64 0 0 64zm-64-96l224 0c35.3 0 64-28.7 64-64l0-224c0-35.3-28.7-64-64-64L224 0c-35.3 0-64 28.7-64 64l0 224c0 35.3 28.7 64 64 64z</Geometry>
    <Geometry x:Key="f.file-export">M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 128-168 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l168 0 0 112c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zM384 336l0-48 110.1 0-39-39c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l80 80c9.4 9.4 9.4 24.6 0 33.9l-80 80c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l39-39L384 336zm0-208l-128 0L256 0 384 128z</Geometry>
    <Geometry x:Key="f.xmark">M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z</Geometry>


    <DataTemplate x:Key="DT.File">
        <DockPanel Background="Transparent" LastChildFill="False">
            <DockPanel.Resources>
                <Style BasedOn="{StaticResource ButtonIcon.Small}" TargetType="Button" />
            </DockPanel.Resources>
            <hc:SimplePanel>
                <local:AbbreviationText
                    x:Name="file"
                    Margin="0,2"
                    VerticalContentAlignment="Center"
                    local:MaskService.IsMask="True"
                    Text="{Binding DisplayName}" />
                <hc:SimplePanel
                    x:Name="p"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Stretch"
                    Background="White"
                    Visibility="Collapsed">
                    <DockPanel Margin="5,2" LastChildFill="False">
                        <DockPanel LastChildFill="False">
                            <Button
                                hc:IconElement.Geometry="{StaticResource f.book-open-reader}"
                                Command="{Binding ViewCommand}"
                                Foreground="Lime"
                                ToolTip="查看" />
                            <Button
                                hc:IconElement.Geometry="{StaticResource f.clone}"
                                Command="{Binding CopyCommand}"
                                Foreground="RoyalBlue"
                                ToolTip="复制" />
                            <Button
                                hc:IconElement.Geometry="{StaticResource f.file-export}"
                                Command="{Binding SaveAsCommand}"
                                ToolTip="另存为" />
                        </DockPanel>
                        <Button
                            Margin="-5"
                            hc:IconElement.Geometry="{StaticResource f.xmark}"
                            Command="{Binding DeleteCommand}"
                            CommandParameter="{Binding .}"
                            Foreground="Red"
                            Style="{StaticResource ButtonIcon.Small}"
                            ToolTip="删除"
                            Visibility="{Binding IsReadOnly, RelativeSource={RelativeSource AncestorType=local:FileViewBase}, Converter={StaticResource Boolean2VisibilityReConverter}}" />
                    </DockPanel>
                </hc:SimplePanel>
            </hc:SimplePanel>
            <TextBlock
                Margin="6,0,0,0"
                VerticalAlignment="Center"
                FontSize="8"
                Foreground="Red"
                Text="文件已被删除"
                Visibility="{Binding Exists, Converter={StaticResource Boolean2VisibilityReConverter}}" />
        </DockPanel>
        <DataTemplate.Triggers>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Exists, TargetNullValue=False}" Value="True" />
                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True" />
                </MultiDataTrigger.Conditions>
                <Setter TargetName="p" Property="Visibility" Value="Visible" />
            </MultiDataTrigger>
            <DataTrigger Binding="{Binding Exists, TargetNullValue=False}" Value="False">
                <Setter TargetName="file" Property="Foreground" Value="Gray" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>


    <DataTemplate x:Key="DefaultHeader">
        <DockPanel LastChildFill="False">
            <TextBlock
                x:Name="lb"
                VerticalAlignment="Center"
                Foreground="{DynamicResource LabelBrush}"
                Text="{Binding Binding.Label, RelativeSource={RelativeSource TemplatedParent}}" />

        </DockPanel>
    </DataTemplate>

    <DataTemplate x:Key="MultiSealedFile">
        <DockPanel>
            <ToggleButton Style="{StaticResource ToggleButtonFlip.Small}" />
            <ContentPresenter
                VerticalAlignment="Center"
                Content="{Binding Normal}"
                ContentTemplate="{StaticResource DT.File}" />
        </DockPanel>
    </DataTemplate>

    <DataTemplate x:Key="DefaultMultiSealedFile">

        <ListBox
            Background="Transparent"
            BorderThickness="0"
            ItemTemplate="{StaticResource MultiSealedFile}"
            ItemsSource="{Binding Files}"
            Style="{DynamicResource ListBoxCustom}" />
    </DataTemplate>

    <!--  Style for MultipleFileView  -->
    <Style TargetType="local:MultiSealedFileView">
        <Setter Property="AllowDrop" Value="{Binding IsReadOnly, RelativeSource={RelativeSource Self}, Converter={StaticResource Boolean2BooleanReConverter}}" />
        <!--<Setter Property="HeaderTemplate" Value="{StaticResource DefaultHeader}" />
        <Setter Property="Header" Value="{Binding Label, FallbackValue=文件}" />-->
        <Setter Property="ContentTemplate" Value="{StaticResource DefaultMultiSealedFile}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:MultiSealedFileView">
                    <Border>
                        <DockPanel Background="Transparent">
                            <ContentPresenter Content="{TemplateBinding Header}" ContentTemplate="{TemplateBinding HeaderTemplate}" />

                            <hc:SimplePanel>
                                <Viewbox
                                    x:Name="arrow"
                                    Width="14"
                                    Height="14"
                                    Margin="2,0,8,0"
                                    VerticalAlignment="Center">
                                    <Path
                                        Data="{DynamicResource f.angle-right}"
                                        Fill="Black"
                                        Stroke="Black" />
                                </Viewbox>
                                <Button
                                    x:Name="add"
                                    hc:IconElement.Geometry="{DynamicResource f.gear}"
                                    Command="{Binding Content.AddFileCommand, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}"
                                    CommandParameter="{Binding ., RelativeSource={RelativeSource TemplatedParent}}"
                                    Style="{DynamicResource ButtonIcon.Small}"
                                    ToolTip="设置文件"
                                    Visibility="Hidden" />
                            </hc:SimplePanel>

                            <ContentPresenter Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" />
                        </DockPanel>
                    </Border>
                    <ControlTemplate.Triggers>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True" />
                                <Condition Property="IsReadOnly" Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="add" Property="Visibility" Value="Visible" />
                            <Setter TargetName="arrow" Property="Visibility" Value="Collapsed" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


</ResourceDictionary>