<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="clr-namespace:FMO.Utilities;assembly=FMO.Data"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    xmlns:shared="clr-namespace:FMO.Shared;assembly=FMO.Shared">

    <Style x:Key="LeftText" TargetType="TextBlock">
        <Setter Property="shared:MaskService.IsMask" Value="True" />
    </Style>
    <Style x:Key="CenterText" TargetType="TextBlock">
        <Setter Property="TextAlignment" Value="Center" />
        <Setter Property="shared:MaskService.IsMask" Value="True" />
    </Style>

    <Style x:Key="DateText" TargetType="TextBlock">
        <Setter Property="TextAlignment" Value="Center" />
    </Style>


    <Style
        x:Key="CenterColumnHeader"
        BasedOn="{StaticResource DataGridColumnHeaderStyle}"
        TargetType="DataGridColumnHeader">
        <Setter Property="HorizontalContentAlignment" Value="Center" />
    </Style>

    <DataTemplate x:Key="ClearDateMissing">
        <DataGrid
            AutoGenerateColumns="False"
            ColumnHeaderStyle="{StaticResource CenterColumnHeader}"
            IsReadOnly="False"
            ItemsSource="{Binding .}"
            Style="{StaticResource DataGrid.NoSelect}">
            <DataGrid.Columns>
                <DataGridTextColumn
                    Binding="{Binding Context.Name}"
                    ElementStyle="{StaticResource LeftText}"
                    Header="基金" />
                <DataGridTextColumn
                    Width="100"
                    Binding="{Binding Context.Code}"
                    ElementStyle="{StaticResource CenterText}"
                    Header="代码" />
                <DataGridTextColumn
                    Width="100"
                    Binding="{Binding Context.Clear, StringFormat=yyyy/MM/dd}"
                    ElementStyle="{StaticResource DateText}"
                    Header="清盘日期" />
                <DataGridTextColumn
                    Binding="{Binding Context.Last, StringFormat=yyyy/MM/dd}"
                    ElementStyle="{StaticResource DateText}"
                    Header="最后更新日期" />
            </DataGrid.Columns>
        </DataGrid>
    </DataTemplate>

    <DataTemplate x:Key="DailyMissing">
        <DataGrid
            AutoGenerateColumns="False"
            IsReadOnly="False"
            ItemsSource="{Binding .}"
            Style="{StaticResource DataGrid.NoSelect}">
            <DataGrid.Columns>
                <DataGridTextColumn
                    Binding="{Binding Context.FundName}"
                    ElementStyle="{StaticResource LeftText}"
                    Header="基金" />
                <DataGridTextColumn Binding="{Binding Context.Count}" Header="数量">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="TextAlignment" Value="Center" />
                            <Setter Property="Margin" Value="8,0" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTemplateColumn Header="日期">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ListBox
                                MaxWidth="500"
                                BorderThickness="0"
                                ItemStringFormat="yyyy/MM/dd"
                                ItemsSource="{Binding Context.MissingSample}"
                                Style="{StaticResource ListBoxCustom}">
                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <hc:UniformSpacingPanel IsItemsHost="True" Spacing="5" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>

                            </ListBox>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </DataTemplate>

    <DataTemplate x:Key="ShareNotPairRuleListItem">
        <DockPanel>
            <TextBlock Text="{Binding Date, StringFormat=yyyy-MM-dd}" />
            <TextBlock
                Width="100"
                Text="{Binding Share}"
                TextAlignment="Right" />
        </DockPanel>
    </DataTemplate>

    <DataTemplate x:Key="ShareNotPairRule">
        <Border Background="WhiteSmoke">
            <DockPanel>
                <ListBox
                    x:Name="list"
                    Background="Transparent"
                    BorderThickness="0"
                    ItemsSource="{Binding .}"
                    SelectedIndex="0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>

                            <DockPanel>
                                <TextBlock shared:MaskService.IsMask="True" Text="{Binding Context.FundName}" />
                                <TextBlock
                                    x:Name="info"
                                    Margin="10,0"
                                    shared:MaskService.IsMask="True"
                                    Foreground="Red"
                                    Text="请先更新净值"
                                    Visibility="Collapsed" />
                            </DockPanel>
                            <DataTemplate.Triggers>
                                <DataTrigger Binding="{Binding Context.ByDailyCount}" Value="0">
                                    <Setter TargetName="info" Property="Visibility" Value="Visible" />
                                </DataTrigger>
                            </DataTemplate.Triggers>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <DataGrid
                    MaxHeight="500"
                    AutoGenerateColumns="False"
                    DataContext="{Binding ElementName=list, Path=SelectedItem.Context}"
                    IsReadOnly="True"
                    ItemsSource="{Binding Diff}"
                    Style="{StaticResource DataGrid.Small}">
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Foreground" Value="Black" />

                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsDiff}" Value="True">
                                    <Setter Property="Foreground" Value="Red" />
                                </DataTrigger>

                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                    <DataGrid.Columns>
                        <DataGridTextColumn Binding="{Binding Date, StringFormat=yyyy/MM/dd}" Header="日期" />
                        <DataGridTextColumn Binding="{Binding ShareByDaily}" Header="净值中的份额" />
                        <DataGridTextColumn Binding="{Binding ShareByTransfer}" Header="TA中的份额" />
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </Border>
    </DataTemplate>


    <DataTemplate x:Key="FundOverdue">
        <DataGrid
            AutoGenerateColumns="False"
            ColumnHeaderStyle="{StaticResource CenterColumnHeader}"
            IsReadOnly="False"
            ItemsSource="{Binding .}"
            Style="{StaticResource DataGrid.NoSelect}">
            <DataGrid.Columns>
                <DataGridTextColumn
                    Binding="{Binding Context.FundName}"
                    ElementStyle="{StaticResource LeftText}"
                    Header="基金" />
                <!--<DataGridTextColumn
                    Width="100"
                    Binding="{Binding Context.Code}"
                    ElementStyle="{StaticResource CenterText}"
                    Header="代码" />-->
                <DataGridTextColumn
                    Width="100"
                    Binding="{Binding Context.SetupDate, StringFormat=yyyy/MM/dd}"
                    ElementStyle="{StaticResource DateText}"
                    Header="成立日期" />
                <DataGridTextColumn
                    Binding="{Binding Context.Expire, StringFormat=yyyy/MM/dd}"
                    ElementStyle="{StaticResource DateText}"
                    Header="到期日" />
                <DataGridTextColumn
                    Width="100"
                    Binding="{Binding Context.ExpiredDays, StringFormat={}{0}天}"
                    ElementStyle="{StaticResource DateText}"
                    Header="超期" />
            </DataGrid.Columns>
        </DataGrid>
    </DataTemplate>


    <DataTemplate x:Key="FundClearNotFinished">
        <DataGrid
            AutoGenerateColumns="False"
            ColumnHeaderStyle="{StaticResource CenterColumnHeader}"
            IsReadOnly="False"
            ItemsSource="{Binding .}"
            Style="{StaticResource DataGrid.NoSelect}">
            <DataGrid.Columns>
                <DataGridTextColumn
                    Binding="{Binding Context.FundName}"
                    ElementStyle="{StaticResource LeftText}"
                    Header="基金" />
                <!--<DataGridTextColumn
                    Width="100"
                    Binding="{Binding Context.Code}"
                    ElementStyle="{StaticResource CenterText}"
                    Header="代码" />-->

            </DataGrid.Columns>
        </DataGrid>
    </DataTemplate>
</ResourceDictionary>